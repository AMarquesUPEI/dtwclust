#' @param error.check Logical indicating whether the function should try to detect inconsistencies
#'   and give more informative errors messages. Also used internally to avoid repeating checks.
